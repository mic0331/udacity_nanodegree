hflights2 <- rita %>%
dcast(Year + Month + DayofMonth ~ UniqueCarrier,
value.var = "speed",fun.aggregate = mean) %>%
subset(select = c(-1,-2,-3)) %>%
(~ hflights3) %>>% # save the wide-format data
list.sort(desc(median(.,na.rm = TRUE))) %>%
boxplot(main = "Boxplot of flight speed sorted by median")
hflights2 <- rita %>%
dcast(Year + Month + DayofMonth ~ UniqueCarrier,
value.var = "speed",fun.aggregate = mean) %>%
subset(select = c(-1,-2,-3)) %>%
(~ hflights3) %>% # save the wide-format data
list.sort(desc(median(.,na.rm = TRUE))) %>%
boxplot(main = "Boxplot of flight speed sorted by median")
rita <- mutate(rita, speed = Distance / (AirTime / 60))
hflights2 <- rita %>%
dcast(Year + Month + DayofMonth ~ UniqueCarrier,
value.var = "speed",fun.aggregate = mean) %>%
subset(select = c(-1,-2,-3)) %>%
(~ hflights3) %>% # save the wide-format data
list.sort(desc(median(.,na.rm = TRUE))) %>%
boxplot(main = "Boxplot of flight speed sorted by median")
library(rlist)       # install.packages("rlist")
install.packages("rlist")
library(rlist)
hflights2 <- rita %>%
dcast(Year + Month + DayofMonth ~ UniqueCarrier,
value.var = "speed",fun.aggregate = mean) %>%
subset(select = c(-1,-2,-3)) %>%
(~ hflights3) %>% # save the wide-format data
list.sort(desc(median(.,na.rm = TRUE))) %>%
boxplot(main = "Boxplot of flight speed sorted by median")
library(reshape2)
hflights2 <- rita %>%
dcast(Year + Month + DayofMonth ~ UniqueCarrier,
value.var = "speed",fun.aggregate = mean) %>%
subset(select = c(-1,-2,-3)) %>%
(~ hflights3) %>% # save the wide-format data
list.sort(desc(median(.,na.rm = TRUE))) %>%
boxplot(main = "Boxplot of flight speed sorted by median")
hflights2 <- rita %>%
dcast(Year + Month + DayofMonth ~ UniqueCarrier,
value.var = "speed",fun.aggregate = mean) %>%
subset(select = c(-1,-2,-3)) %>%
(~ hflights3)
hflights2
hflights2 <- rita %>%
dcast(Year + Month + DayofMonth ~ UniqueCarrier,
value.var = "speed",fun.aggregate = mean) %>%
subset(select = c(-1,-2,-3)) %>%
(~ hflights3) %>% # save the wide-format data
list.sort(desc(median(speed,na.rm = TRUE))) %>%
boxplot(main = "Boxplot of flight speed sorted by median")
hflights2 <- rita %>%
dcast(Year + Month + DayofMonth ~ UniqueCarrier,
value.var = "speed",fun.aggregate = mean) %>%
subset(select = c(-1,-2,-3)) %>%
(~ hflights3) %>% # save the wide-format data
list.sort(desc(median(.,na.rm = TRUE))) %>%
boxplot(main = "Boxplot of flight speed sorted by median")
airportcounts %
mutate(Date = ymd(paste(Year, “-“, Month, “-01″, sep=“”)))
head(airportcounts)
airportcounts <- rita %>%
mutate(Date = ymd(paste(Year, “-“, Month, “-01″, sep=“”)))
data <- mutate(Date = ymd(paste(Year, “-“, Month, “-01″, sep=“”)))
str(carriers)
data[,"UniqueCarrier"]<-carriers[data[ ,"UniqueCarrier"], "Description"]
qplot(x = UniqueCarrier, data = data, fill = UniqueCarrier) +
theme_bw() +
coord_flip() +
xlab(NULL) +
guides(fill=guide_legend(ncol=2)) +
theme(legend.position="bottom", legend.direction = "horizontal")
carriers
View(carriers)
data <- merge(data, carriers, by=c("UniqueCarrier", "Code"))
merged.data <- merge(data, carriers, by=c("UniqueCarrier", "Code"))
merged.data <- merge(data, carriers, by.x="UniqueCarrier", by.y="Code")
qplot(x = UniqueCarrier, data = merged.data, fill = UniqueCarrier) +
theme_bw() +
coord_flip() +
xlab(NULL) +
guides(fill=guide_legend(ncol=2)) +
theme(legend.position="bottom", legend.direction = "horizontal")
data
View(data)
data = rita
merged.data <- merge(data, carriers, by.x="UniqueCarrier", by.y="Code")
View(merged.data)
qplot(x = UniqueCarrier, data = merged.data, fill = UniqueCarrier) +
theme_bw() +
coord_flip() +
xlab(NULL) +
guides(fill=guide_legend(ncol=2)) +
theme(legend.position="bottom", legend.direction = "horizontal")
qplot(x = UniqueCarrier, data = merged.data, fill = Description) +
theme_bw() +
coord_flip() +
xlab(NULL) +
guides(fill=guide_legend(ncol=2)) +
theme(legend.position="bottom", legend.direction = "horizontal")
setwd("/Users/mic0331/Documents/TRAINING/Data Analysis/Courses/Nanodegree Data Analyst/Projects/udacity_nanodegree/P3/data")
rita.rita_speed_distance = subset(rita, rita$speed >= 0 & rita$speed <= 600)
m1 <- lm(Distance ~ speed, data = rita.rita_speed_distance, na.action=na.omit)
p + geom_abline(m1$intercept, m1$slope, colour = "red")
summary(m1)
rita_2001 <- read.csv("rita_2001_busy.csv")
rita_2001$Month <- sprintf("%02d", rita_2001$Month)
rita_2001$DayofMonth <- sprintf("%02d", rita_2001$DayofMonth)
rita_2001 <- mutate(rita_2001,
date = as.Date(paste(rita_2001$Year, rita_2001$Month,
rita_2001$DayofMonth, sep=""),
"%Y%m%d"))
rita_2001.rita_2001_per_day <- rita_2001 %>%
group_by(date, Dest) %>%
filter(!is.na(ArrDelay)) %>%
summarise(
arr_delay = mean(ArrDelay),
n = n()
) %>%
arrange(date, Dest) %>%
left_join(location)
rita_2001.rita_2001_per_day <- rita_2001 %>%
group_by(date, Dest) %>%
filter(!is.na(ArrDelay)) %>%
summarise(
arr_delay = mean(ArrDelay),
n = n()
) %>%
arrange(date, Dest) %>%
left_join(location)
rita_2001 <- mutate(rita_2001,
date = as.Date(paste(rita_2001$Year, rita_2001$Month,
rita_2001$DayofMonth, sep=""),
"%Y%m%d"))
rita_2001.rita_2001_per_day <- rita_2001 %>%
group_by(date, Dest) %>%
filter(!is.na(ArrDelay)) %>%
summarise(
arr_delay = mean(ArrDelay),
n = n()
) %>%
arrange(date, Dest) %>%
left_join(location)
library(knitr)
library(dplyr)
library(reshape2)
require(ggplot2)
library(gridExtra)
library(grid)
library(scales)
library(freqweights)
library(maps)
library(GGally)
rita_2001.rita_2001_per_day <- rita_2001 %>%
group_by(date, Dest) %>%
filter(!is.na(ArrDelay)) %>%
summarise(
arr_delay = mean(ArrDelay),
n = n()
) %>%
arrange(date, Dest) %>%
left_join(location)
conflicts()
detach("plyr", unload=TRUE)
detach("package:plyr", unload=TRUE)
detach_package(plyr)
unloadNamespace("plyr")
library(knitr)
library(dplyr)
library(reshape2)
require(ggplot2)
library(gridExtra)
library(grid)
library(scales)
library(freqweights)
library(maps)
library(GGally)
rita = read.csv('./rita.csv')
airports = read.csv('./airports.csv')
carriers = read.csv('./carriers.csv')
columns = read.csv('./columns.csv', sep=";")
# We adjust the date features formats
rita$Month <- sprintf("%02d", rita$Month)
rita$DepTime <- sprintf("%04d", rita$DepTime)
rita$ArrTime <- sprintf("%04d", rita$ArrTime)
rita$DayOfWeek <- sprintf("%02d", rita$DayOfWeek)
rita$DayofMonth <- sprintf("%02d", rita$DayofMonth)
# speed in miles / hour
rita <- mutate(rita, speed = Distance / (AirTime / 60))
# full date of the departure
rita <- mutate(rita, date = as.Date(paste(rita$Year, rita$Month,
rita$DayofMonth, sep=""), "%Y%m%d"))
rita_2001 <- read.csv("2001.csv")
rita_2001 <- read.csv("rita_2001_busy.csv")
rita_2001$Month <- sprintf("%02d", rita_2001$Month)
rita_2001$DayofMonth <- sprintf("%02d", rita_2001$DayofMonth)
rita_2001 <- mutate(rita_2001,
date = as.Date(paste(rita_2001$Year, rita_2001$Month,
rita_2001$DayofMonth, sep=""),
"%Y%m%d"))
rita_2001.rita_2001_per_day <- rita_2001 %>%
group_by(date, Dest) %>%
filter(!is.na(ArrDelay)) %>%
summarise(
arr_delay = mean(ArrDelay),
n = n()
) %>%
arrange(date, Dest) %>%
left_join(location)
rita_2001 <- mutate(rita_2001,
date = as.Date(paste(rita_2001$Year, rita_2001$Month,
rita_2001$DayofMonth, sep=""),
"%Y%m%d"))
rita_2001.rita_2001_per_day <- rita_2001 %>%
group_by(date, Dest) %>%
filter(!is.na(ArrDelay)) %>%
summarise(
arr_delay = mean(ArrDelay),
n = n()
) %>%
arrange(date, Dest) %>%
left_join(location)
rita.no_missing <- filter(rita, !is.na(DepDelay) & !is.na(ArrDelay))
rita.by_year <- group_by(rita.no_missing, Year)
rita.DepDelays <- summarise(rita.by_year,
mean = mean(DepDelay, na.rm = TRUE),
median = median(DepDelay * 1.0, na.rm = TRUE),
q75 = quantile(DepDelay, .75, na.rm = TRUE),
q25 = quantile(DepDelay, .25, na.rm = TRUE),
over_15 = mean(DepDelay > 15, na.rm = TRUE),
over_30 = mean(DepDelay > 30, na.rm = TRUE),
over_60 = mean(DepDelay > 60, na.RM = TRUE))
rita.ArrDelays <- summarise(rita.by_year,
mean = mean(ArrDelay, na.rm = TRUE),
median = median(ArrDelay * 1.0, na.rm = TRUE),
q75 = quantile(ArrDelay, .75, na.rm = TRUE),
q25 = quantile(ArrDelay, .25, na.rm = TRUE),
over_15 = mean(ArrDelay > 15, na.rm = TRUE),
over_30 = mean(ArrDelay > 30, na.rm = TRUE),
over_60 = mean(ArrDelay > 60, na.RM = TRUE))
p1 <- ggplot(rita.DepDelays, aes(x = factor(Year), y = mean)) +
geom_bar(stat = "identity", fill="lightblue") +
geom_line(aes(y=q75, group=1, color="red")) +
geom_point(aes(y=q75)) +
geom_line(aes(y=q25, group=1, color="blue")) +
geom_point(aes(y=q25)) +
geom_line(aes(y=median, group=1, color="yellow")) +
geom_point(aes(y=median)) +
scale_color_manual("Quartile",labels = c("Q25 % (lower quartile)",
"Q75 % (upper quantile)", "median"),
values = c("blue", "red", "yellow")) +
xlab('Year') +
ggtitle('Departure') +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = .5, vjust=0.5)) +
theme(legend.position="bottom", legend.direction = "horizontal")
p2 <- ggplot(rita.ArrDelays, aes(x = factor(Year), y = mean)) +
geom_bar(stat = "identity", fill="lightblue") +
geom_line(aes(y=q75, group=1, color="red")) +
geom_point(aes(y=q75)) +
geom_line(aes(y=q25, group=1, color="blue")) +
geom_point(aes(y=q25)) +
geom_line(aes(y=median, group=1, color="yellow")) +
geom_point(aes(y=median)) +
scale_color_manual("Quartile",labels = c("Q25 % (lower quartile)",
"Q75 % (upper quantile)", "median"),
values = c("blue", "red", "yellow")) +
xlab('Year') +
ggtitle('Arrival') +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = .5, vjust=0.5)) +
theme(legend.position="bottom", legend.direction = "horizontal")
grid.arrange(p1, p2, ncol = 1, heights=unit(0.5, "npc"))
rita$DayOfWeek <- factor(rita$DayOfWeek,
levels = c('01','02','03','04','05','06','07'),
labels = c("Monday", "Tuesday", "Wednesday",
"Thursday", "Friday", "Saterday", "Sunday"))
ggplot(rita, aes(x=DayOfWeek)) +
geom_histogram() +
theme_bw()
rita.year_day_of_week <- rita %>%
group_by(Year, DayOfWeek) %>%
summarise(ArrDelay_mean = mean(ArrDelay * 1.0, na.rm=T),
ArrDelay_median = median(ArrDelay * 1.0, na.rm=T),
n = n()) %>%
arrange(Year, DayOfWeek)
ggplot(rita.year_day_of_week, aes(x=Year, y=ArrDelay_mean)) +
geom_line(aes(colour=DayOfWeek)) +
ylab('Arrival Delay (min)') +
theme_bw()
ggplot(subset(rita.year_day_of_week, rita.year_day_of_week$Year >2000),
aes(x=DayOfWeek, y=ArrDelay_mean)) +
geom_point(aes(colour=DayOfWeek)) +
facet_grid(.~Year, scales="free") +
ylab('Arrival Delay (min)') +
theme_bw() +
theme(axis.text.x=element_blank())
rita.taxi_in_origin <- rita.taxi_in_origin %>%
group_by(Origin) %>%
mutate( ngroup= sum(freq), wgroup= freq/ngroup)
rita.taxi_in_origin <- filter(rita, !is.na(TaxiIn))
rita.taxi_in_origin <- tablefreq(rita[,c("TaxiIn","Origin")])
rita.taxi_in_origin <- head(arrange(rita.taxi_in_origin, -freq), n=100)
ggplot(aes(x=TaxiIn, weight= freq, colour = Origin), data = rita.taxi_in_origin, position ="dodge") +
geom_bar() +
theme_bw()
rita.taxi_in_origin <- rita.taxi_in_origin %>%
group_by(Origin) %>%
mutate( ngroup= sum(freq), wgroup= freq/ngroup)
ggplot(aes(x=TaxiIn, weight=wgroup, colour = Origin),data = rita.taxi_in_origin) +
geom_density() +
theme_bw()
ggplot(aes(x=TaxiIn, weight=wgroup),data = rita.taxi_in_origin) +
geom_density() +
theme_bw()
ggplot(aes(x=TaxiIn, weight= freq), data = rita.taxi_in_origin, position ="dodge") +
geom_bar() +
theme_bw()
ggplot(aes(x=TaxiIn, weight=wgroup),data = rita.taxi_in_origin) +
geom_density() +
theme_bw()
ggplot(aes(x=TaxiIn, weight= freq), data = rita.taxi_in_origin, position ="dodge") +
geom_bar() +
theme_bw()
ggplot(aes(x=TaxiIn, weight=wgroup),data = rita.taxi_in_origin) +
geom_density() +
theme_bw()
rita.per_hour <- rita %>%
filter(Cancelled == 'No' & !is.na(rita$AirTime)) %>%
mutate(time = AirTime / 60) %>%
group_by(time) %>%
summarise(
arr_delay = mean(ArrDelay, na.rm = TRUE),
n = n()
)
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
theme_bw()
rita = read.csv('./rita.csv')
airports = read.csv('./airports.csv')
carriers = read.csv('./carriers.csv')
columns = read.csv('./columns.csv', sep=";")
rita$Month <- sprintf("%02d", rita$Month)
rita$DepTime <- sprintf("%04d", rita$DepTime)
rita$ArrTime <- sprintf("%04d", rita$ArrTime)
rita$DayOfWeek <- sprintf("%02d", rita$DayOfWeek)
rita$DayofMonth <- sprintf("%02d", rita$DayofMonth)
rita <- mutate(rita, speed = Distance / (AirTime / 60))
rita <- mutate(rita, date = as.Date(paste(rita$Year, rita$Month,
rita$DayofMonth, sep=""), "%Y%m%d"))
rita.per_hour <- rita %>%
filter(Cancelled == 'No' & !is.na(rita$AirTime)) %>%
mutate(time = AirTime / 60) %>%
group_by(time) %>%
summarise(
arr_delay = mean(ArrDelay, na.rm = TRUE),
n = n()
)
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
theme_bw()
ggplot(filter(rita.per_hour, n > 30), aes(time, arr_delay)) +
geom_point() +
stat_smooth() +
theme_bw()
rita.per_hour <- rita %>%
filter(Cancelled == 'No' & !is.na(rita$AirTime)) %>%
mutate(time = AirTime / 60) %>%
group_by(time) %>%
summarise(
arr_delay = mean(ArrDelay, na.rm = TRUE),
n = n()
)
rita$Cancelled <- factor(rita$Cancelled,
levels = c(0,1),
labels = c("No", "Yes"))
rita.per_hour <- rita %>%
filter(Cancelled == 'No' & !is.na(rita$AirTime)) %>%
mutate(time = AirTime / 60) %>%
group_by(time) %>%
summarise(
arr_delay = mean(ArrDelay, na.rm = TRUE),
n = n()
)
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
theme_bw()
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
xlim(-100, 300) +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
ylim(-100, 300) +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
ylim(-100, 100) +
xlim(-5, 10) +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
ylim(-100, 100) +
xlim(0, 10) +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
ylim(-25, 100) +
xlim(0, 10) +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
ylim(-15, 100) +
xlim(0, 10) +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
ylim(-15, 50) +
xlim(0, 10) +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
qplot(time, arr_delay, data = rita.per_hour, size = n, alpha = .3) +
scale_size_area() +
ylim(-15, 50) +
xlim(0, 10) +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
ylim(-15, 50) +
xlim(0, 10) +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
qplot(time, arr_delay, data = rita.per_hour, size = n) +
scale_size_area() +
ylim(-15, 50) +
xlim(0, 8) +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
ggplot(filter(rita.per_hour, n > 30), aes(time, arr_delay)) +
geom_point() +
stat_smooth() +
theme_bw()
ggplot(filter(rita.per_hour, n > 30), aes(time, arr_delay)) +
geom_point() +
stat_smooth() +
labs(x = "flight time in hours",
y = "Delay (hours)") +
theme_bw()
rita.monthly_delay.wide <- rita %>%
mutate(month=Month, carrier=UniqueCarrier) %>%
group_by(month, carrier) %>%
summarize(delay=sum(ArrDelay, na.rm=T)) %>%
dcast(month ~ carrier, value.var = "delay")
head(rita.monthly_delay.wide, 5)
rita.monthly_delay <- rita %>%
mutate(month=Month, carrier=UniqueCarrier) %>%
group_by(month, carrier) %>%
summarize(delay=mean(ArrDelay, na.rm=T))
rita.monthly_delay$month <- factor(rita.monthly_delay$month,
levels = c('01', '02', '03', '04', '05', '06', '07', '08', '09',
'10', '11', '12'),
labels = c("January","February","March","April","May","June",
"July","Augus","September","October","November",
"December"))
ggplot(NULL, aes(x=month, y=delay, fill=carrier, alpha=.2)) +
geom_bar(data=rita.monthly_delay %>% filter(delay > 0),
stat='identity',
position = "identity",
colour="black") +
geom_bar(data=rita.monthly_delay %>% filter(delay < 0),
stat='identity',
position = "identity",
colour="black") +
labs(x = "Month",
y = "Delay (hours)") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = .5, vjust=0.5))
ggplot(NULL, aes(x=month, y=delay, color=carrier)) +
geom_point(data=rita.monthly_delay %>% filter(delay > 0),
stat='identity',
position = "identity") +
geom_point(data=rita.monthly_delay %>% filter(delay < 0),
stat='identity',
position = "identity") +
labs(x = "Month",
y = "Delay (hours)") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = .5, vjust=0.5))
